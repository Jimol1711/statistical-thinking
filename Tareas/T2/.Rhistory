cte <- rep(0.5,1000)
x <- 1:1000
data <- c()
for (n in x) {
X <- rbinom(n, 1, 0.5)
epsilon_sigma <- rnorm(1, 0, 1)  # sigma = 1
p_hat <- epsilon_sigma + mean(X)
data <- c(data, p_hat)
}
df_1 <- data.frame(x = x, p_hat = data)
bias_1 <- calculate_bias(data)
p2 <- ggplot(df_1, aes(x = x, y = p_hat)) +
geom_line(color = "red") +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "black") +
labs(title = "Estimator of p (sigma = 1)", x = "n", y = "Estimator of p") +
theme_minimal()
# sigma = 2
cte <- rep(0.5,1000)
x <- 1:1000
data <- c()
for (n in x) {
X <- rbinom(n, 1, 0.5)
epsilon_sigma <- rnorm(1, 0, 2)  # sigma = 2
p_hat <- epsilon_sigma + mean(X)
data <- c(data, p_hat)
}
df_2 <- data.frame(x = x, p_hat = data)
bias_2 <- calculate_bias(data)
p3 <- ggplot(df_2, aes(x = x, y = p_hat)) +
geom_line(color = "green") +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "black") +
labs(title = "Estimator of p (sigma = 2)", x = "n", y = "Estimator of p") +
theme_minimal()
# sigma = 4
cte <- rep(0.5,1000)
x <- 1:1000
data <- c()
for (n in x) {
X <- rbinom(n, 1, 0.5)
epsilon_sigma <- rnorm(1, 0, 4)  # sigma = 4
p_hat <- epsilon_sigma + mean(X)
data <- c(data, p_hat)
}
df_4 <- data.frame(x = x, p_hat = data)
bias_4 <- calculate_bias(data)
p4 <- ggplot(df_4, aes(x = x, y = p_hat)) +
geom_line(color = "purple") +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "black") +
labs(title = "Estimator of p (sigma = 4)", x = "n", y = "Estimator of p") +
theme_minimal()
# Print plots
print(p1)
print(p2)
print(p3)
print(p4)
# Print out the biases for each sigma
cat("Bias for sigma = 0:", bias_0, "\n")
cat("Bias for sigma = 1:", bias_1, "\n")
cat("Bias for sigma = 2:", bias_2, "\n")
cat("Bias for sigma = 4:", bias_4, "\n")
datos <- read.csv("diabetes_prediction_dataset.csv", header = TRUE)
head(datos)
# Definimos tamaños de muestreo
tamano_muestra = 100
n_muestras = 10000
# Inicializamos estructuras necesarias
list_mean_bmi = vector()
list_interval_bmi = vector()
list_typeCI_bmi = vector()
list_prop_bmi = vector()
sucess_bmi = 0
list_mean_bgl = vector()
list_interval_bgl = vector()
list_typeCI_bgl = vector()
list_prop_bgl = vector()
sucess_bgl = 0
# Obtenemos la media y desviación estándar de cada columna
# Sampling distribution, calculo del intervalo de confianza y proporción.
for (i in 1:n_muestras) {
}
# Generamos dataframes para plotear mas facilmente los datos.
# Definimos tamaños de muestreo
tamano_muestra = 100
n_muestras = 10000
# Inicializamos estructuras necesarias
list_mean_bmi = vector()
list_interval_bmi = vector()
list_typeCI_bmi = vector()
list_prop_bmi = vector()
sucess_bmi = 0
list_mean_bgl = vector()
list_interval_bgl = vector()
list_typeCI_bgl = vector()
list_prop_bgl = vector()
sucess_bgl = 0
# Obtenemos la media y desviación estándar de cada columna
real_mean_bmi <- mean(datos$bmi)
real_mean_bgl <- mean(datos$blood_glucose_level)
# Sampling distribution, calculo del intervalo de confianza y proporción.
for (i in 1:n_muestras) {
}
# Generamos dataframes para plotear mas facilmente los datos.
# Definimos tamaños de muestreo
tamano_muestra = 100
n_muestras = 10000
# Inicializamos estructuras necesarias
list_mean_bmi = vector()
list_interval_bmi = vector()
list_typeCI_bmi = vector()
list_prop_bmi = vector()
sucess_bmi = 0
list_mean_bgl = vector()
list_interval_bgl = vector()
list_typeCI_bgl = vector()
list_prop_bgl = vector()
sucess_bgl = 0
# Obtenemos la media y desviación estándar de cada columna
real_mean_bmi <- mean(datos$bmi)
real_mean_bgl <- mean(datos$blood_glucose_level)
real_sd_bmi <- sd(datos$bmi)
real_sd_bgl <- sd(datos$blood_glucose_level)
# Sampling distribution, calculo del intervalo de confianza y proporción.
for (i in 1:n_muestras) {
}
# Generamos dataframes para plotear mas facilmente los datos.
# Definimos tamaños de muestreo
tamano_muestra = 100
n_muestras = 5000
# Inicializamos estructuras necesarias
list_mean_bmi = vector()
list_interval_bmi = vector()
list_typeCI_bmi = vector()
list_prop_bmi = vector()
sucess_bmi = 0
list_mean_bgl = vector()
list_interval_bgl = vector()
list_typeCI_bgl = vector()
list_prop_bgl = vector()
sucess_bgl = 0
# Obtenemos la media y desviación estándar de cada columna
real_mean_bmi <- mean(datos$bmi)
real_sd_bmi <- sd(datos$bmi)
real_mean_bgl <- mean(datos$blood_glucose_level)
real_sd_bgl <- sd(datos$blood_glucose_level)
# Sampling distribution, calculo del intervalo de confianza y proporción.
for (i in 1:n_muestras) {
# Generating samples
sample_bmi <- sample(datos$bmi, tamano_muestra)
sample_bgl <- sample(datos$blood_glucose_level, tamano_muestra)
}
# Generamos dataframes para plotear mas facilmente los datos.
# Definimos tamaños de muestreo
tamano_muestra = 100
n_muestras = 5000
# Inicializamos estructuras necesarias
list_mean_bmi = vector()
list_interval_bmi = vector()
list_typeCI_bmi = vector()
list_prop_bmi = vector()
sucess_bmi = 0
list_mean_bgl = vector()
list_interval_bgl = vector()
list_typeCI_bgl = vector()
list_prop_bgl = vector()
sucess_bgl = 0
# Obtenemos la media y desviación estándar de cada columna
real_mean_bmi <- mean(datos$bmi)
real_sd_bmi <- sd(datos$bmi)
real_mean_bgl <- mean(datos$blood_glucose_level)
real_sd_bgl <- sd(datos$blood_glucose_level)
# Sampling distribution, calculo del intervalo de confianza y proporción.
for (i in 1:n_muestras) {
# Generating samples
sample_bmi <- sample(datos$bmi, tamano_muestra)
sample_bgl <- sample(datos$blood_glucose_level, tamano_muestra)
# Sampling distribution of the mean
list_mean_bmi <- c(list_mean_bmi, mean(sample_bmi))
list_mean_bgl <- c(list_mean_bgl, mean(sample_bgl))
}
# Generamos dataframes para plotear mas facilmente los datos.
# Manipulación de estructuras
library(tidyverse)
# Para realizar plots
library(ggplot2)
library(plotly)
# Manipulación de varios plots en una imagen.
library(gridExtra)
# Function to calculate bias
calculate_bias <- function(estimates, p_true = 0.5) {
mean(estimates) - p_true
}
# sigma = 0
cte <- rep(0.5, 1000)
x <- 1:1000
data <- c()
for (n in x) {
X <- rbinom(n, 1, 0.5)
epsilon_sigma <- rnorm(1, 0, 0)
p_hat <- epsilon_sigma + mean(X)
data <- c(data, p_hat)
}
df_0 <- data.frame(x = x, p_hat = data)
bias_0 <- calculate_bias(data)
# Create individual plots
p1 <- ggplot(df_0, aes(x = x, y = p_hat)) +
geom_line(color = "blue") +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "black") +
labs(title = "Estimator of p (sigma = 0)", x = "n", y = "Estimator of p") +
theme_minimal()
# sigma = 1
cte <- rep(0.5,1000)
x <- 1:1000
data <- c()
for (n in x) {
X <- rbinom(n, 1, 0.5)
epsilon_sigma <- rnorm(1, 0, 1)  # sigma = 1
p_hat <- epsilon_sigma + mean(X)
data <- c(data, p_hat)
}
df_1 <- data.frame(x = x, p_hat = data)
bias_1 <- calculate_bias(data)
p2 <- ggplot(df_1, aes(x = x, y = p_hat)) +
geom_line(color = "red") +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "black") +
labs(title = "Estimator of p (sigma = 1)", x = "n", y = "Estimator of p") +
theme_minimal()
# sigma = 2
cte <- rep(0.5,1000)
x <- 1:1000
data <- c()
for (n in x) {
X <- rbinom(n, 1, 0.5)
epsilon_sigma <- rnorm(1, 0, 2)  # sigma = 2
p_hat <- epsilon_sigma + mean(X)
data <- c(data, p_hat)
}
df_2 <- data.frame(x = x, p_hat = data)
bias_2 <- calculate_bias(data)
p3 <- ggplot(df_2, aes(x = x, y = p_hat)) +
geom_line(color = "green") +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "black") +
labs(title = "Estimator of p (sigma = 2)", x = "n", y = "Estimator of p") +
theme_minimal()
# sigma = 4
cte <- rep(0.5,1000)
x <- 1:1000
data <- c()
for (n in x) {
X <- rbinom(n, 1, 0.5)
epsilon_sigma <- rnorm(1, 0, 4)  # sigma = 4
p_hat <- epsilon_sigma + mean(X)
data <- c(data, p_hat)
}
df_4 <- data.frame(x = x, p_hat = data)
bias_4 <- calculate_bias(data)
p4 <- ggplot(df_4, aes(x = x, y = p_hat)) +
geom_line(color = "purple") +
geom_hline(yintercept = 0.5, linetype = "dashed", color = "black") +
labs(title = "Estimator of p (sigma = 4)", x = "n", y = "Estimator of p") +
theme_minimal()
# Print plots
print(p1)
print(p2)
print(p3)
print(p4)
# Print out the biases for each sigma
cat("Bias for sigma = 0:", bias_0, "\n")
cat("Bias for sigma = 1:", bias_1, "\n")
cat("Bias for sigma = 2:", bias_2, "\n")
cat("Bias for sigma = 4:", bias_4, "\n")
datos <- read.csv("diabetes_prediction_dataset.csv", header = TRUE)
head(datos)
# Definimos tamaños de muestreo
tamano_muestra = 100
n_muestras = 5000
# Inicializamos estructuras necesarias
list_mean_bmi = vector()
list_interval_bmi = vector()
list_typeCI_bmi = vector()
list_prop_bmi = vector()
sucess_bmi = 0
list_mean_bgl = vector()
list_interval_bgl = vector()
list_typeCI_bgl = vector()
list_prop_bgl = vector()
sucess_bgl = 0
# Obtenemos la media y desviación estándar de cada columna
real_mean_bmi <- mean(datos$bmi)
real_sd_bmi <- sd(datos$bmi)
real_mean_bgl <- mean(datos$blood_glucose_level)
real_sd_bgl <- sd(datos$blood_glucose_level)
# Sampling distribution, calculo del intervalo de confianza y proporción.
for (i in 1:n_muestras) {
# Generating samples
sample_bmi <- sample(datos$bmi, tamano_muestra)
sample_bgl <- sample(datos$blood_glucose_level, tamano_muestra)
# Sampling distribution of the mean
list_mean_bmi <- c(list_mean_bmi, mean(sample_bmi))
list_mean_bgl <- c(list_mean_bgl, mean(sample_bgl))
# Calculating and obtaining confidence interval
list_interval_bmi <- c(list_interval_bmi, abs(list_mean_bmi[i]-real_mean_bmi))
list_interval_bgl <- c(list_interval_bgl, abs(list_mean_bgl[i]-real_mean_bgl))
}
# Generamos dataframes para plotear mas facilmente los datos.
# Definimos tamaños de muestreo
tamano_muestra = 100
n_muestras = 5000
# Inicializamos estructuras necesarias
list_mean_bmi = vector()
list_interval_bmi = vector()
list_typeCI_bmi = vector()
list_prop_bmi = vector()
sucess_bmi = 0
list_mean_bgl = vector()
list_interval_bgl = vector()
list_typeCI_bgl = vector()
list_prop_bgl = vector()
sucess_bgl = 0
# Obtenemos la media y desviación estándar de cada columna
real_mean_bmi <- mean(datos$bmi)
real_sd_bmi <- sd(datos$bmi)
real_mean_bgl <- mean(datos$blood_glucose_level)
real_sd_bgl <- sd(datos$blood_glucose_level)
# Sampling distribution, calculo del intervalo de confianza y proporción.
for (i in 1:n_muestras) {
# Generating samples
sample_bmi <- sample(datos$bmi, tamano_muestra)
sample_bgl <- sample(datos$blood_glucose_level, tamano_muestra)
# Sampling distribution of the mean
list_mean_bmi <- c(list_mean_bmi, mean(sample_bmi))
list_mean_bgl <- c(list_mean_bgl, mean(sample_bgl))
# Calculating and obtaining confidence interval
list_interval_bmi <- c(list_interval_bmi, abs(list_mean_bmi[i]-real_mean_bmi))
list_interval_bgl <- c(list_interval_bgl, abs(list_mean_bgl[i]-real_mean_bgl))
}
# Generamos dataframes para plotear mas facilmente los datos.
# Definimos tamaños de muestreo
tamano_muestra = 100
n_muestras = 5000
# Inicializamos estructuras necesarias
list_mean_bmi = vector()
list_interval_bmi = vector()
list_typeCI_bmi = vector()
list_prop_bmi = vector()
sucess_bmi = 0
list_mean_bgl = vector()
list_interval_bgl = vector()
list_typeCI_bgl = vector()
list_prop_bgl = vector()
sucess_bgl = 0
# Obtenemos la media y desviación estándar de cada columna
real_mean_bmi <- mean(datos$bmi)
real_sd_bmi <- sd(datos$bmi)
real_mean_bgl <- mean(datos$blood_glucose_level)
real_sd_bgl <- sd(datos$blood_glucose_level)
# Sampling distribution, calculo del intervalo de confianza y proporción.
for (i in 1:n_muestras) {
# Generating samples
sample_bmi <- sample(datos$bmi, tamano_muestra)
sample_bgl <- sample(datos$blood_glucose_level, tamano_muestra)
# Sampling distribution of the mean
list_mean_bmi <- c(list_mean_bmi, mean(sample_bmi))
list_mean_bgl <- c(list_mean_bgl, mean(sample_bgl))
# Standard deviations of the samples
sd_bmi <- sd(sample_bmi)
sd_bgl <- sd(sample_bgl)
# Calculating confidence intervals for bmi
margin_error_bmi <- z_value * (sd_bmi / sqrt(tamano_muestra))
ci_lower_bmi <- mean_bmi - margin_error_bmi
ci_upper_bmi <- mean_bmi + margin_error_bmi
list_interval_bmi <- rbind(list_interval_bmi, c(ci_lower_bmi, ci_upper_bmi))
# Calculating confidence intervals for blood_glucose_level
margin_error_bgl <- z_value * (sd_bgl / sqrt(tamano_muestra))
ci_lower_bgl <- mean_bgl - margin_error_bgl
ci_upper_bgl <- mean_bgl + margin_error_bgl
list_interval_bgl <- rbind(list_interval_bgl, c(ci_lower_bgl, ci_upper_bgl))
# Verifying if the real mean is within the confidence interval for bmi
if (ci_lower_bmi <= real_mean_bmi && ci_upper_bmi >= real_mean_bmi) {
sucess_bmi <- sucess_bmi + 1
}
# Verifying if the real mean is within the confidence interval for blood_glucose_level
if (ci_lower_bgl <= real_mean_bgl && ci_upper_bgl >= real_mean_bgl) {
sucess_bgl <- sucess_bgl + 1
}
}
ci_upper_bgl <- mean_bgl + margin_error_bgl
# Definimos tamaños de muestreo
tamano_muestra = 100
n_muestras = 5000
# Inicializamos estructuras necesarias
list_mean_bmi = vector()
list_interval_bmi = vector()
list_typeCI_bmi = vector()
list_prop_bmi = vector()
sucess_bmi = 0
list_mean_bgl = vector()
list_interval_bgl = vector()
list_typeCI_bgl = vector()
list_prop_bgl = vector()
sucess_bgl = 0
# Obtenemos la media y desviación estándar de cada columna
real_mean_bmi <- mean(datos$bmi)
real_sd_bmi <- sd(datos$bmi)
real_mean_bgl <- mean(datos$blood_glucose_level)
real_sd_bgl <- sd(datos$blood_glucose_level)
# Sampling distribution, calculo del intervalo de confianza y proporción.
for (i in 1:n_muestras) {
# Generating samples
sample_bmi <- sample(datos$bmi, tamano_muestra)
sample_bgl <- sample(datos$blood_glucose_level, tamano_muestra)
# Sampling distribution of the mean
list_mean_bmi <- c(list_mean_bmi, mean(sample_bmi))
list_mean_bgl <- c(list_mean_bgl, mean(sample_bgl))
# Standard deviations of the samples
sd_bmi <- sd(sample_bmi)
sd_bgl <- sd(sample_bgl)
# Calculating confidence intervals for bmi
margin_error_bmi <- 1.96 * (sd_bmi / sqrt(tamano_muestra))
ci_lower_bmi <- mean_bmi - margin_error_bmi
ci_upper_bmi <- mean_bmi + margin_error_bmi
list_interval_bmi <- rbind(list_interval_bmi, c(ci_lower_bmi, ci_upper_bmi))
# Calculating confidence intervals for blood_glucose_level
margin_error_bgl <- 1.96 * (sd_bgl / sqrt(tamano_muestra))
ci_lower_bgl <- mean_bgl - margin_error_bgl
ci_upper_bgl <- mean_bgl + margin_error_bgl
list_interval_bgl <- rbind(list_interval_bgl, c(ci_lower_bgl, ci_upper_bgl))
# Verifying if the real mean is within the confidence interval for bmi
if (ci_lower_bmi <= real_mean_bmi && ci_upper_bmi >= real_mean_bmi) {
sucess_bmi <- sucess_bmi + 1
}
# Verifying if the real mean is within the confidence interval for blood_glucose_level
if (ci_lower_bgl <= real_mean_bgl && ci_upper_bgl >= real_mean_bgl) {
sucess_bgl <- sucess_bgl + 1
}
}
# Definimos tamaños de muestreo
tamano_muestra = 100
n_muestras = 5000
# Inicializamos estructuras necesarias
list_mean_bmi = vector()
list_interval_bmi = vector()
list_typeCI_bmi = vector()
list_prop_bmi = vector()
sucess_bmi = 0
list_mean_bgl = vector()
list_interval_bgl = vector()
list_typeCI_bgl = vector()
list_prop_bgl = vector()
sucess_bgl = 0
# Obtenemos la media y desviación estándar de cada columna
real_mean_bmi <- mean(datos$bmi)
real_sd_bmi <- sd(datos$bmi)
real_mean_bgl <- mean(datos$blood_glucose_level)
real_sd_bgl <- sd(datos$blood_glucose_level)
# Sampling distribution, calculo del intervalo de confianza y proporción.
for (i in 1:n_muestras) {
# Generating samples
sample_bmi <- sample(datos$bmi, tamano_muestra)
sample_bgl <- sample(datos$blood_glucose_level, tamano_muestra)
# Sampling distribution of the mean
list_mean_bmi <- c(list_mean_bmi, mean(sample_bmi))
list_mean_bgl <- c(list_mean_bgl, mean(sample_bgl))
# Standard deviations of the samples
sd_bmi <- sd(sample_bmi)
sd_bgl <- sd(sample_bgl)
# Calculating confidence intervals for bmi
margin_error_bmi <- 1.96 * (sd_bmi / sqrt(tamano_muestra))
ci_lower_bmi <- mean(sample_bmi) - margin_error_bmi
ci_upper_bmi <- mean(sample_bmi) + margin_error_bmi
list_interval_bmi <- rbind(list_interval_bmi, c(ci_lower_bmi, ci_upper_bmi))
# Calculating confidence intervals for blood_glucose_level
margin_error_bgl <- 1.96 * (sd_bgl / sqrt(tamano_muestra))
ci_lower_bgl <- mean(sample_bgl) - margin_error_bgl
ci_upper_bgl <- mean(sample_bgl) + margin_error_bgl
list_interval_bgl <- rbind(list_interval_bgl, c(ci_lower_bgl, ci_upper_bgl))
# Verifying if the real mean is within the confidence interval for bmi
if (ci_lower_bmi <= real_mean_bmi && ci_upper_bmi >= real_mean_bmi) {
sucess_bmi <- sucess_bmi + 1
}
# Verifying if the real mean is within the confidence interval for blood_glucose_level
if (ci_lower_bgl <= real_mean_bgl && ci_upper_bgl >= real_mean_bgl) {
sucess_bgl <- sucess_bgl + 1
}
}
# Proporción de intervalos que contienen la media real
prop_bmi <- sucess_bmi / n_muestras
prop_bgl <- sucess_bgl / n_muestras
cat("Proporción de intervalos que contienen la media real (BMI):", prop_bmi, "\n")
cat("Proporción de intervalos que contienen la media real (Blood Glucose Level):", prop_bgl, "\n")
# Convertir los datos a dataframes
df_bmi <- data.frame(
mean = list_mean_bmi,
lower = list_interval_bmi[, 1],
upper = list_interval_bmi[, 2]
)
df_bgl <- data.frame(
mean = list_mean_bgl,
lower = list_interval_bgl[, 1],
upper = list_interval_bgl[, 2]
)
# Gráfico para BMI
ggplot(df_bmi, aes(x = 1:n_muestras, y = mean)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
geom_hline(yintercept = real_mean_bmi, color = "red", linetype = "dashed") +
labs(title = "Intervalos de Confianza para BMI", x = "Muestra", y = "Media BMI")
# Gráfico para Blood Glucose Level
ggplot(df_bgl, aes(x = 1:n_muestras, y = mean)) +
geom_point() +
geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
geom_hline(yintercept = real_mean_bgl, color = "red", linetype = "dashed") +
labs(title = "Intervalos de Confianza para Blood Glucose Level", x = "Muestra", y = "Media Blood Glucose Level")
